% English Article template created by Vopaaz
\documentclass{article}
\usepackage{geometry}
\geometry{a4paper}
\usepackage{setspace}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{hyperref}
\hypersetup{colorlinks,allcolors=black}

\setenumerate[1]{itemsep=0pt,partopsep=2pt,parsep=0pt ,topsep=2pt}
\setitemize[1]{itemsep=0pt,partopsep=2pt,parsep=0pt ,topsep=2pt}
\setenumerate[2]{itemsep=0pt,partopsep=2pt,parsep=0pt ,topsep=2pt}
\setitemize[2]{itemsep=0pt,partopsep=2pt,parsep=0pt ,topsep=2pt}
\setdescription{itemsep=0pt,partopsep=2pt,parsep=0pt ,topsep=2pt}

\usepackage{graphicx}
\usepackage{fontspec}

\usepackage{amsmath}
\usepackage{amssymb}

\usepackage[ruled, linesnumbered]{algorithm2e}
\usepackage{float}

\defaultfontfeatures{%
	RawFeature={%
		+swsh,
		+calt
	}%
}

\setmainfont{EB Garamond}

%-----------%

\title{Introduction to Artificial Intelligence Writing 4}
\author{YiFan Li\\ZeYuan Yang}
\date{\today}

\begin{document}

\addfontfeatures{RawFeature={+smcp}}
\maketitle
\addfontfeatures{RawFeature={-smcp}}

%-------%

\section{Introduction}

On today's financial market, increasing number of financial indexes are being created.
Take the stock market as an example.
Up till now, there have been over 200 generic rules
that can suggest a buying or selling or selling decision
based on the historical stock price time series \cite{stock-timing-using-genetic-algorithms}.
Some of the most prevailing ones include moving average, relative strength indicator, stochastic oscillator, etc.
However, these rules have at least three flaws.
Firstly, all of these rules seems somewhat arbitrary, and are highly unstable.
They could perform well on some stocks, but might fail on others.
Secondly, it's impossible for a human trader to integrate all these 200 rules in his mind
and make a trading decision.
Thirdly, most of the indexes have some parameters as output, for example the time window for moving average,
the choice of what number should be used for these parameters are still empirical.

Both stock market practitioner and academic researchers have devoted huge effort to determine good interpreters
that can help make profitable decisions in the financial market.
Additionally, with the rise of quantitative trading,
which means trading stocks by computer program instead of a human trader,
the need for algorithmically select good financial indexes have become more important.

To be more specific, the problem setting can be summarized as follows:
\begin{itemize}
	\item Given a historical stock price time series in the past $n$ periods, $P_t=\left[p_{t-n}, p_{t-n+1}, \cdots, p_{t-1}\right]$,
	      where $t$ represents the present,
	\item and a set of $k$ trading rules suggesting ``buy", ``sell" or ``hold" action based on the time series\\
	      $R=\{r_1, r_2, \cdots, r_k\}, \forall r_i(P_t) \rightarrow s_i \in \{\text{sell}, \text{buy}, \text{hold}\}$,
	\item design an agent $A$ who can integrate all the rules to make a final decision\\
	      $A(R(P_t)) \rightarrow d_t \in \{\text{sell}, \text{buy}, \text{hold}\}$,
	\item that can maximize the profit in the following $m$ period,
	      which can be calculated as $\sum \limits_{t=0}^{m} p_{t}^{\text{sell}} - p_{t}^{\text{buy}}$,\\
	      $p_{t}^{\text{sell}} = \left\{
		      \begin{array}{ll}
			      p_t \quad & \text{if} A(R(P_t)) = \text{sell} \wedge A \text{ currently holds the stock} \\
			      0 \quad   & \text{otherwise}
		      \end{array}\right.,\\
		      p_t^{\text{buy}} = \left\{
		      \begin{array}{ll}
			      p_t \quad & \text{if} A(R(P_t)) = \text{buy} \wedge A \text{ currently not holds the stock} \\
			      0 \quad   & \text{otherwise}
		      \end{array}
		      \right.$
\end{itemize}

We are not considering the service charge
because it could make it difficult to design an evaluation benchmark that can be
calculated without conducting another complete search.

\section{Approach}

We are aiming to solve this problem with genetic algorithm.
On one hand, the problem setting can be considered as a search problem,
which tries to find the best combination of trading rules from all possibilities.
The evaluation function can also be very easily defined.
On the other hand, there are already some previous studies using the same approach \cite{genetic-algorithms-for-predicting-the-egyptian-stock-market} \cite{genetic-algorithms-to-optimise-the-time-to-make-stock-market-investment}.
We can based our project on their findings and dig deeper.

\section{Implementation Plan}

For the experiment, we will have to gather data and implement the algorithm.

\subsection{Data}

We can find the historical stock data for free on \href{https://www.alphavantage.co/}{Alpha Vantage}.
It provides a lot of APIs and we can get the data via HTTP requests.
The data pipeline, however, will have to be built by ourselves.
We will use Python to grab data and save it as csv files for further use.

We plan to gather 3 years' data and use the first two years as the train set,
and the last one year as test set.
With this architecture, our agent does not only find the optimal strategy for the history,
but also have some generalization ability and therefore have the potential to be applied on the market in practice.

\subsection{Algorithm}

We will use Python to implement the genetic algorithm and whatever strategies to be tested.
We have found a Python package, \href{https://github.com/PytLab/gaft}{gaft}, that serve as a framework for running genetic algorithm.

What needs to be built from scratch includes all the empirical trading rules,
and possibly some variant strategies of the genetic algorithm that are not included in gaft.

\section{Analysis Plan}

The benchmark of our evaluation is an agent who can ``predict the future".
It knows the whole time series and make decision based on it,
$A'(P_m, t) \rightarrow d'_t$.
It can be implemented with the following trivial algorithm.
\begin{algorithm}[H]
	\KwData{prices}
	\KwData{today}
	\SetKwData{prices}{prices}
	\SetKwData{today}{today}
	\KwResult{decision}

	\uIf{$\prices[\today+1] > \prices[\today]$}{
		\Return{buy}\;
	}\uElseIf{$\prices[\today+1] < \prices[\today]$}{
		\Return{sell}\;
	}\Else{
		\Return{hold}\;
	}
	\caption{Benchmark Agent}
\end{algorithm}

The evaluation function used in the genetic algorithm will be
$\dfrac{
		\operatorname{Profit}(\text{genetic agent})
	}{
		\operatorname{Profit}(\text{benchmark agent})
	}$ and the goal is to maximize it.

We may also choose some trading rules and build agents who make decisions based solely
on each one of them to see how much improvement is brought by the genetic algorithm.

The runtime and memory usage will also be measured,
but generally they can be controlled by setting the maximum round of iteration and population.
Therefore we will not emphasis too much on it.

% TODO: We have found several variants for genetic algorithms and we will implement them.
% Citation!

During our research, we also found several variants for genetic algorithms which we will implement in our project.
We will illustrate three different variants here, concerning three different parts of genetic algorithm.

The fist variant adapts the format of the chromosome.
Instead of traditional bit-string representations of integers in the chromosome, this variant may use other data types, for instance, arrays of real-valued numbers.
Different chromosomal data types are suitable for different specific problems.
Therefore, we may implement this variant with numeric chromosomal data type to figure out whether it will have a better performance.



The experiment will be conducted in two stages.
In the first stage, the test dataset will not be used.
We will only try to find the hyper parameters that leads to the best performance on the train dataset.
In the second stage, we will run the genetic algorithm on the train dataset as before,
but the trained agent will be applied on the test dataset to measure its final performance.
The idea is borrowed from machine learning, that only optimizing on the train dataset could cause overfitting.
The test dataset, which is invisible during the training state, can test the agent's generalization ability.
We will also try to find the best hyper parameters for the second stage and compare it with those in the first stage,
which hopefully could inspire us about how the choice of hyper parameters and strategies can serve as overfitting prevention.


\section{Timeline}


Now that we have had an outline of our project, we will get down to it right now.
To figure out the result, in chronological order, we need to scratch and process the data, construct algorithm model and analysis the result.
Each of these three parts requires abundant effort.
We plan to finish the project primarily in about three weeks.

We plan to finish the first part in this week, by Nov 24th.
As mentioned in the Implementation Plan part, we will grab the data from Alpha Vantage.
After we get the data, we need to figure out what format of data is usable for our algorithm.
Then we need to process the data into our target format and construct the train dataset and test dataset. 
The entire data preparation is scheduled to be done in five days.

After we have the clean data, we will construct the algorithm model and run the program, in the next week.
In this part, we will choose the trading rules, build agents and then do the experiment.
The agents are the essential of the project.
It needs to be figured out how to implement genetic algorithm on the trading rules.
In addition, we will also try to apply the mentioned variants of genetic algorithm as well.
Therefore, we schedule to finish this part in the Thanksgiving break.
The experiment is supposed to be finished by Dec 1st.

Next, we will analysis the result we get in the second part.
We assign a whole week time to this part.
To get insightful conclusions for the project, we plan to dig into the results first.
Moreover, we will discuss what we find and revise our conclusions.
How to present our conclusion is also a crucial portion of this part.
Visualizations may be required as well.
If everything goes well, we will finish the draft of our project by Dec 8th.

In the last week of this semester, we will focus on refining our conclusion and revising our documentation.
The last job of this project is to go through the whole essay and the algorithm to find where we can improve.
We will drop unnecessary illustration and keep amending until we submit the final submission.
The project is scheduled to be submitted by Dec 14th, so that we can have 4 days for emergency.


%-------%

\bibliographystyle{abbrv}
\bibliography{proposal}

\end{document}



